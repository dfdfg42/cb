<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>카드 배틀 게임</title>
</head>
<body>
    <div id="app">
        <!-- 메인 화면 -->
        <div id="main-screen" class="screen active">
            <div class="main-container">
                <h1 class="game-title">카드 배틀</h1>
                <div class="login-box">
                    <input type="text" id="username-input" class="username-input" placeholder="닉네임을 입력하세요" maxlength="12">
                    <button id="enter-btn" class="btn btn-primary">입장하기</button>
                </div>
            </div>
        </div>

        <!-- 로비 화면 -->
        <div id="lobby-screen" class="screen">
            <div class="lobby-container">
                <div class="lobby-header">
                    <h2>로비</h2>
                    <span id="user-name-display" class="user-name"></span>
                </div>
                <div class="lobby-buttons">
                    <button id="normal-game-btn" class="btn btn-game">
                        <span class="btn-icon">⚔️</span>
                        <span class="btn-text">일반전</span>
                    </button>
                    <button id="rank-game-btn" class="btn btn-game">
                        <span class="btn-icon">🏆</span>
                        <span class="btn-text">랭크전</span>
                    </button>
                    <button id="help-btn" class="btn btn-game">
                        <span class="btn-icon">❓</span>
                        <span class="btn-text">도움말</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- 대기실 화면 -->
        <div id="waiting-screen" class="screen">
            <div class="waiting-container">
                <div class="waiting-header">
                    <button id="leave-room-btn" class="btn btn-small">나가기</button>
                    <h2 id="room-type">대기실</h2>
                </div>
                <div class="players-waiting">
                    <div class="player-slot" id="player-slot-0">
                        <div class="empty-slot">대기 중...</div>
                    </div>
                    <div class="player-slot" id="player-slot-1">
                        <div class="empty-slot">대기 중...</div>
                    </div>
                    <div class="player-slot" id="player-slot-2">
                        <div class="empty-slot">대기 중...</div>
                    </div>
                    <div class="player-slot" id="player-slot-3">
                        <div class="empty-slot">대기 중...</div>
                    </div>
                </div>
                <button id="ready-btn" class="btn btn-primary">준비</button>
            </div>
        </div>

        <!-- 게임 화면 -->
        <div id="game-screen" class="screen">
            <!-- 상단 플레이어 정보 -->
            <div class="players-info">
                <div class="player-info" id="player-info-0"></div>
                <div class="player-info" id="player-info-1"></div>
                <div class="player-info" id="player-info-2"></div>
                <div class="player-info" id="player-info-3"></div>
            </div>

            <!-- 중앙 전투 필드 -->
            <div class="battle-field">
                <div class="turn-counter">턴: <span id="turn-number">1</span></div>
                <div class="field-magic-area" id="field-magic-area">
                    <span class="field-magic-label">필드 마법 없음</span>
                </div>
                
                <div class="combat-area">
                    <div class="attacker-area">
                        <div class="combat-label">공격자</div>
                        <div class="combat-name" id="attacker-name">-</div>
                        <div class="cards-played" id="attacker-cards"></div>
                    </div>
                    
                    <div class="vs-divider">VS</div>
                    
                    <div class="defender-area">
                        <div class="combat-label">방어자</div>
                        <div class="combat-name" id="defender-name">-</div>
                        <div class="cards-played" id="defender-cards"></div>
                    </div>
                </div>

                <div class="game-log" id="game-log">
                    <div class="log-message">게임이 시작되었습니다!</div>
                </div>

                <!-- 전투 요약 (공격자 -> 방어자, 사용 카드, 데미지, 상태이상) -->
                <div id="combat-summary" class="combat-summary">
                    <div class="summary-line">
                        <span class="summary-label">공격자 → 방어자</span>
                        <span id="summary-players" class="summary-value">- → -</span>
                    </div>
                    <div class="summary-line">
                        <span class="summary-label">사용 카드</span>
                        <span id="summary-cards" class="summary-value">-</span>
                    </div>
                    <div class="summary-line">
                        <span class="summary-label">데미지</span>
                        <span id="summary-damage" class="summary-value">0</span>
                    </div>
                    <div class="summary-line">
                        <span class="summary-label">상태이상</span>
                        <span id="summary-debuffs" class="summary-value">-</span>
                    </div>
                    <div class="summary-line">
                        <span class="summary-label">남은 시간</span>
                        <span id="summary-timer" class="summary-value">-</span>
                    </div>
                    <div class="summary-line">
                        <span class="summary-label">행동</span>
                        <span class="summary-value">
                            <button id="summary-take-btn" class="btn btn-secondary btn-small">그냥 맞기</button>
                        </span>
                    </div>
                </div>
            </div>

            <!-- 하단 플레이어 손패 -->
            <div class="player-hand-area">
                <div class="hand-cards" id="hand-cards"></div>
                <div class="action-buttons">
                    <button id="confirm-btn" class="btn btn-primary" disabled>확정</button>
                    <button id="end-turn-btn" class="btn btn-secondary">턴 종료</button>
                </div>
            </div>
        </div>

        <!-- 게임 오버 화면 -->
        <div id="game-over-screen" class="screen">
            <div class="game-over-container">
                <div class="game-over-content">
                    <h1 id="game-over-title" class="game-over-title">승리!</h1>
                    <div id="game-over-message" class="game-over-message">
                        축하합니다! 모든 적을 물리쳤습니다!
                    </div>
                    <div class="game-over-stats">
                        <div class="stat-item">
                            <span class="stat-label">생존 턴</span>
                            <span id="final-turn" class="stat-value">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">최종 체력</span>
                            <span id="final-health" class="stat-value">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">최종 정신력</span>
                            <span id="final-mental" class="stat-value">0</span>
                        </div>
                    </div>
                    <div class="game-over-buttons">
                        <button id="restart-btn" class="btn btn-primary">다시 시작</button>
                        <button id="to-lobby-btn" class="btn btn-secondary">로비로</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 도움말 화면 -->
        <div id="help-screen" class="screen">
            <div class="help-container">
                <div class="help-header">
                    <button id="back-to-lobby-btn" class="btn btn-small">뒤로가기</button>
                    <h2>게임 도움말</h2>
                </div>
                <div class="help-content">
                    <section>
                        <h3>📖 게임 규칙</h3>
                        <p>최대 4명이 참여하는 턴제 카드 배틀 게임입니다.</p>
                        <p>각 플레이어는 9장의 카드로 시작하며, 상대방을 공격하고 방어하여 최후의 1인이 되는 것이 목표입니다.</p>
                    </section>

                    <section>
                        <h3>🎴 카드 종류</h3>
                        <ul>
                            <li><strong>공격 카드 (빨강)</strong>: 상대에게 데미지를 입힙니다. + 접두사가 있으면 여러 장 사용 가능</li>
                            <li><strong>방어 카드 (파랑)</strong>: 공격을 막거나 반사, 튕기기 등의 특수 효과</li>
                            <li><strong>마법 카드 (보라)</strong>: 정신력을 소모하여 특수 효과 발동 (1장만 사용 가능)</li>
                            <li><strong>필드 마법 (초록)</strong>: 전장 전체에 영향을 주는 강력한 마법</li>
                        </ul>
                    </section>

                    <section>
                        <h3>⚔️ 전투 방식</h3>
                        <p>1. 공격자가 공격 카드를 선택하고 대상을 지정</p>
                        <p>2. 방어자가 방어 카드를 선택하거나 데미지 수용</p>
                        <p>3. 되받아치기나 튕기기 사용 시 연쇄 대응 가능</p>
                    </section>

                    <section>
                        <h3>😈 특수 이벤트</h3>
                        <p><strong>악마 (50턴 이후)</strong>: 랜덤 플레이어에게 10~30 데미지 또는 카드 2장 삭제</p>
                        <p><strong>천사 (낮은 확률)</strong>: 랜덤 플레이어에게 체력/정신력 +10</p>
                    </section>

                    <section>
                        <h3>💀 정신력 0</h3>
                        <p>정신력이 0이 되면 강력한 디버프가 랜덤으로 적용됩니다.</p>
                        <p>- 매 턴 카드 1장 소멸</p>
                        <p>- 공격 대상 랜덤 지정</p>
                    </section>

                    <section>
                        <h3>🏆 승리 조건</h3>
                        <p>다른 모든 플레이어의 체력을 0으로 만들어 최후의 1인이 되세요!</p>
                    </section>
                </div>
            </div>
        </div>

        <!-- 카드 상세 모달 -->
        <div id="card-detail-modal" class="modal">
            <div class="modal-content">
                <div class="card-detail-view">
                    <div class="card-detail-image"></div>
                    <h3 class="card-detail-name"></h3>
                    <div class="card-detail-stats"></div>
                    <p class="card-detail-description"></p>
                    <button class="btn btn-primary close-modal">닫기</button>
                </div>
            </div>
        </div>

        <!-- 대상 선택 모달 -->
        <div id="target-selection-modal" class="modal">
            <div class="modal-content">
                <div class="target-selection-view">
                    <h3>공격 대상 선택</h3>
                    <div class="target-players" id="target-players">
                        <!-- 동적으로 생성됨 -->
                    </div>
                </div>
            </div>
        </div>
    </div>

        <!-- 방어 요청 모달 (중앙 큰 표시) -->
        <div id="defend-modal" class="modal">
            <div class="modal-content defend-modal-content">
                <div class="defend-center" id="defend-center">
                    <div class="defend-attribute" id="defend-attribute">속성: -</div>
                    <div class="defend-damage" id="defend-damage">데미지: 0</div>
                    <div class="defend-instructions">방어 카드를 선택하거나 아래 버튼으로 데미지를 수용하세요.</div>
                    <div class="defend-actions">
                        <button id="use-defense-btn" class="btn btn-primary">방어 카드 사용</button>
                        <button id="take-it-btn" class="btn btn-secondary">그냥 맞기</button>
                    </div>
                </div>
            </div>
        </div>
</body>
</html>
