# 🎮 게임 메커니즘 가이드

## 📋 목차
1. [게임 개요](#게임-개요)
2. [카드 시스템](#카드-시스템)
3. [전투 시스템](#전투-시스템)
4. [멘탈 파워 시스템](#멘탈-파워-시스템)
5. [디버프 시스템](#디버프-시스템)
6. [필드 마법](#필드-마법)
7. [승리 조건](#승리-조건)

---

## 게임 개요

### 기본 정보
- **장르**: 턴제 카드 배틀 게임
- **플레이어**: 4명 (멀티플레이어)
- **플랫폼**: 웹 브라우저 (HTML5)
- **테마**: 정신력(멘탈 파워) 기반 전투

### 게임 목표
마지막까지 살아남는 플레이어가 승리합니다. 다른 플레이어의 **체력(HP)**를 0으로 만들어 제거하세요!

---

## 카드 시스템

### 카드 타입

#### 1. 공격 카드 (ATTACK)
상대에게 직접 데미지를 입히는 카드입니다.

**예시**:
- **정신 공격** - 비용: 5 / 데미지: 15
- **집중 타격** - 비용: 8 / 데미지: 25
- **광역 공격** - 비용: 12 / 데미지: 20 (모든 적에게)

```typescript
{
  id: '001',
  name: '정신 공격',
  type: CardType.ATTACK,
  cost: 5,
  power: 15,
  target: 'single',
  description: '대상에게 15 데미지를 입힙니다.'
}
```

#### 2. 방어 카드 (DEFENSE)
체력을 회복하거나 보호막을 생성합니다.

**예시**:
- **정신 치유** - 비용: 6 / 회복: 20 HP
- **마음의 방패** - 비용: 8 / 보호막: 30
- **집단 치유** - 비용: 15 / 모든 아군 회복

```typescript
{
  id: '008',
  name: '정신 치유',
  type: CardType.DEFENSE,
  cost: 6,
  power: 20,
  effect: CardEffect.HEAL,
  description: '자신의 체력을 20 회복합니다.'
}
```

#### 3. 마법 카드 (MAGIC)
특수 효과를 발동하는 카드입니다.

**효과 종류**:
- **반사 (REFLECT)**: 받은 데미지를 공격자에게 돌려줌
- **바운스 (BOUNCE)**: 데미지를 다른 플레이어에게 튕김
- **디버프 (DEBUFF)**: 상대의 능력치 감소
- **필드 마법 (FIELD)**: 전체 게임에 영향

**예시**:
```typescript
{
  id: '012',
  name: '정신 반사',
  type: CardType.MAGIC,
  cost: 7,
  effect: CardEffect.REFLECT,
  duration: 2,
  description: '2턴 동안 받은 데미지의 50%를 반사합니다.'
}
```

### 카드 속성

| 속성 | 설명 | 예시 |
|------|------|------|
| **id** | 카드 고유 ID | '001', '002', ... |
| **name** | 카드 이름 | '정신 공격' |
| **type** | 카드 타입 | ATTACK, DEFENSE, MAGIC |
| **cost** | 멘탈 파워 비용 | 5, 10, 15 |
| **power** | 효과 수치 | 데미지, 회복량 등 |
| **effect** | 특수 효과 | REFLECT, BOUNCE, DEBUFF |
| **target** | 대상 지정 | 'single', 'all', 'self' |
| **duration** | 지속 시간 | 턴 수 (1, 2, 3, ...) |

### 카드 비용 시스템

모든 카드는 **멘탈 파워**를 소모합니다:

```
기본 턴 충전: +10 멘탈 파워/턴
카드 사용 시: -카드 비용
최대 멘탈 파워: 100

예시:
- 턴 시작: 멘탈 파워 30
- 카드 사용 (비용 5): 30 - 5 = 25
- 다음 턴: 25 + 10 = 35
```

---

## 전투 시스템

### 턴 진행 순서

```
1. 턴 시작
   ├─ 멘탈 파워 충전 (+10)
   ├─ 카드 드로우 (1장)
   └─ 디버프 지속시간 감소

2. 행동 페이즈
   ├─ 카드 선택
   ├─ 타겟 지정
   └─ 카드 사용

3. 효과 처리
   ├─ 데미지 계산
   ├─ 반사 체인 처리
   ├─ 바운스 체인 처리
   └─ 상태 업데이트

4. 턴 종료
   └─ 다음 플레이어로 순환
```

### 데미지 계산

#### 기본 데미지
```typescript
최종 데미지 = 카드 파워 × (1 + 공격력 보너스) × (1 - 방어력)
```

#### 디버프 적용
```typescript
// 공격 약화 (ATTACK_DOWN)
데미지 = 카드 파워 × 0.7  // 30% 감소

// 방어 약화 (DEFENSE_DOWN)
받는 데미지 × 1.3  // 30% 증가
```

#### 필드 마법 적용
```typescript
// 공격력 증가 필드
데미지 × 1.2  // 20% 증가

// 방어력 증가 필드
받는 데미지 × 0.8  // 20% 감소
```

### 반사(Reflect) 체인

**메커니즘**:
1. 공격자 A가 B를 공격 (데미지 30)
2. B가 반사 상태 → A에게 15 데미지 반사 (50%)
3. A가 반사 상태 → B에게 7.5 데미지 재반사 (50%)
4. 반사 체인 계속... (최대 10회)

```typescript
// 반사 계산
function calculateReflect(damage: number, reflectRate: number): number {
  return damage * reflectRate * 0.5; // 50% 반사율
}

// 체인 예시
턴 0: A → B (30 데미지)
턴 1: B → A (15 데미지, 반사)
턴 2: A → B (7.5 데미지, 재반사)
턴 3: B → A (3.75 데미지, 재반사)
...
```

**반사 상태**:
- 지속 시간: 2턴
- 반사율: 50%
- 스택 가능: 여러 반사 카드 사용 시 효과 누적

### 바운스(Bounce) 체인

**메커니즘**:
1. 공격자 A가 B를 공격 (데미지 30)
2. B가 바운스 상태 → C에게 15 데미지 튕김 (50%)
3. C가 바운스 상태 → D에게 7.5 데미지 튕김
4. 바운스 체인 계속... (최대 10회)

```typescript
// 바운스 계산
function calculateBounce(damage: number): number {
  return damage * 0.5; // 50% 바운스
}

// 체인 예시
A → B (30 데미지)
  └─ B 바운스 → C (15 데미지)
       └─ C 바운스 → D (7.5 데미지)
            └─ D 바운스 → A (3.75 데미지)
```

**바운스 타겟 선택**:
```typescript
// 우선순위
1. 공격자가 아닌 생존 플레이어
2. 체력이 가장 높은 플레이어
3. 랜덤 선택 (동일 체력 시)
```

### 멘탈 파워 전이

**데미지를 입히면 멘탈 파워 획득**:
```typescript
획득량 = Math.floor(입힌 데미지 × 0.3)

예시:
- A가 B에게 30 데미지
- A가 획득: 30 × 0.3 = 9 멘탈 파워
- B가 잃음: 9 멘탈 파워 (체력과 별개)
```

**반사/바운스 시에도 전이**:
```typescript
// 반사 데미지로도 멘탈 파워 획득
A → B (30 데미지) → A가 9 획득
B 반사 → A (15 데미지) → B가 4.5 획득
```

---

## 멘탈 파워 시스템

### 기본 메커니즘

```
초기 멘탈 파워: 50
최대 멘탈 파워: 100
턴당 충전량: +10

사용:
- 카드 사용 시 소모
- 0 이하가 되면 카드 사용 불가

획득:
- 턴 시작 시 자동 충전
- 데미지를 입히면 추가 획득
- 일부 카드로 회복 가능
```

### 전략적 활용

#### 1. 공격 중심 전략
```
높은 비용 카드로 큰 데미지
→ 멘탈 파워 대량 획득
→ 연속 공격 가능
```

#### 2. 방어 중심 전략
```
낮은 비용 카드로 생존
→ 멘탈 파워 축적
→ 결정타 준비
```

#### 3. 밸런스 전략
```
공격과 방어 균형
→ 안정적인 멘탈 파워 관리
→ 상황 대응력 확보
```

### 멘탈 파워 부족 시

```typescript
// 카드 사용 불가 조건
if (player.mentalPower < card.cost) {
  return '멘탈 파워가 부족합니다!';
}

// UI 표시
카드에 빨간색 테두리 + 잠금 아이콘
```

---

## 디버프 시스템

### 디버프 타입

#### 1. 공격 약화 (ATTACK_DOWN)
```typescript
{
  type: DebuffType.ATTACK_DOWN,
  duration: 2,  // 2턴 지속
  value: 0.3    // 30% 감소
}

효과:
- 입히는 데미지 30% 감소
- 공격 카드 파워 × 0.7
- 아이콘: 🔻 (빨간색 화살표 아래)
```

#### 2. 방어 약화 (DEFENSE_DOWN)
```typescript
{
  type: DebuffType.DEFENSE_DOWN,
  duration: 2,
  value: 0.3
}

효과:
- 받는 데미지 30% 증가
- 들어오는 데미지 × 1.3
- 아이콘: 🛡️💔 (깨진 방패)
```

#### 3. 침묵 (SILENCE)
```typescript
{
  type: DebuffType.SILENCE,
  duration: 1,
  value: 1.0
}

효과:
- 마법 카드 사용 불가
- 공격/방어 카드만 사용 가능
- 아이콘: 🔇 (음소거)
```

#### 4. 기절 (STUN)
```typescript
{
  type: DebuffType.STUN,
  duration: 1,
  value: 1.0
}

효과:
- 1턴 행동 불가
- 자동으로 턴 스킵
- 아이콘: 💫 (현기증)
```

### 디버프 관리

#### 적용
```typescript
// 디버프 카드 사용
player.useCard({
  name: '정신 혼란',
  effect: CardEffect.DEBUFF,
  debuffType: DebuffType.ATTACK_DOWN,
  duration: 2
});

// 대상 플레이어에게 적용
target.debuffs.push({
  type: DebuffType.ATTACK_DOWN,
  duration: 2,
  value: 0.3
});
```

#### 해제
```typescript
// 턴 종료 시 자동 감소
turnEnd() {
  player.debuffs.forEach(debuff => {
    debuff.duration--;
    if (debuff.duration <= 0) {
      removeDebuff(debuff);
    }
  });
}

// 해제 카드 사용
{
  name: '정신 정화',
  effect: CardEffect.CLEANSE,
  description: '모든 디버프 제거'
}
```

#### 스택
```typescript
// 동일한 디버프 중복 시
if (hasDebuff(player, DebuffType.ATTACK_DOWN)) {
  // 지속 시간 갱신 (최대값)
  existingDebuff.duration = Math.max(
    existingDebuff.duration,
    newDebuff.duration
  );
} else {
  // 새로운 디버프 추가
  player.debuffs.push(newDebuff);
}
```

---

## 필드 마법

### 필드 마법이란?

전체 게임판에 영향을 주는 특수 효과입니다.

```
특징:
- 모든 플레이어에게 영향
- 3~5턴 지속
- 동시에 1개만 활성화
- 새로운 필드 마법 사용 시 기존 효과 종료
```

### 필드 마법 종류

#### 1. 공격력 증가 필드
```typescript
{
  name: '광기의 장막',
  effect: FieldEffect.ATTACK_BOOST,
  duration: 3,
  value: 0.2  // 20% 증가
}

효과:
- 모든 공격 데미지 +20%
- 공격 중심 플레이어에게 유리
```

#### 2. 방어력 증가 필드
```typescript
{
  name: '평화의 결계',
  effect: FieldEffect.DEFENSE_BOOST,
  duration: 3,
  value: 0.2  // 20% 감소
}

효과:
- 모든 받는 데미지 -20%
- 방어 중심 플레이어에게 유리
```

#### 3. 멘탈 파워 증가 필드
```typescript
{
  name: '정신력 폭발',
  effect: FieldEffect.MENTAL_BOOST,
  duration: 4,
  value: 5  // +5 추가
}

효과:
- 턴당 멘탈 파워 충전량 +5
- 기본 10 → 15로 증가
- 고비용 카드 사용 용이
```

#### 4. 반사 필드
```typescript
{
  name: '거울의 차원',
  effect: FieldEffect.REFLECT_FIELD,
  duration: 3,
  value: 0.3  // 30% 반사
}

효과:
- 모든 플레이어가 30% 반사 상태
- 공격 시 역습 위험
```

### 필드 마법 전략

#### 선공 전략
```
자신에게 유리한 필드 먼저 사용
→ 상대보다 유리한 환경 확보
→ 공세 주도권 장악
```

#### 카운터 전략
```
상대 필드 마법에 대응
→ 즉시 새로운 필드 마법 사용
→ 상대 효과 무효화
```

#### 타이밍 전략
```
결정적 순간에 필드 마법 사용
→ 대량 데미지 or 회복 극대화
→ 게임 흐름 전환
```

---

## 승리 조건

### 기본 승리
```
조건: 자신을 제외한 모든 플레이어 제거
방법: 상대 체력을 0으로 만들기
```

### 패배 조건
```
1. 체력 0 도달
   → 즉시 게임에서 제외
   → 관전 모드로 전환

2. 연결 끊김
   → 자동 패배 처리
   → AI로 대체 (옵션)
```

### 순위 결정
```
1위: 마지막 생존자
2위: 마지막으로 제거된 플레이어
3위: 두 번째로 제거된 플레이어
4위: 첫 번째로 제거된 플레이어

보상:
- 1위: 100 포인트
- 2위: 50 포인트
- 3위: 25 포인트
- 4위: 10 포인트 (참가상)
```

---

## 고급 전략

### 1. 멘탈 파워 관리
```
✅ DO:
- 턴마다 10씩 충전되므로 계획적 사용
- 데미지로 획득한 멘탈 파워 활용
- 필드 마법으로 충전량 증가

❌ DON'T:
- 한 번에 모든 멘탈 파워 소진
- 비상 상황 대비하지 않음
```

### 2. 타겟 우선순위
```
우선 타겟:
1. 체력이 낮은 플레이어 (처치 가능)
2. 멘탈 파워가 높은 플레이어 (위협)
3. 강력한 디버프가 있는 플레이어

회피 타겟:
1. 반사 상태 플레이어
2. 바운스 상태 플레이어
3. 보호막이 있는 플레이어
```

### 3. 카드 조합
```
공격 콤보:
- 방어 약화 → 대형 공격 → 추가 공격

생존 콤보:
- 치유 → 보호막 → 반사

방해 콤보:
- 침묵 → 기절 → 공격
```

### 4. 필드 마법 활용
```
공격 타이밍:
- 공격력 증가 필드 활성화 중
- 대량 데미지 극대화

방어 타이밍:
- 방어력 증가 필드 활성화 중
- 상대 공격 최소화

전환 타이밍:
- 불리한 필드 → 즉시 새 필드 마법
- 게임 흐름 뒤집기
```

---

## 팁 & 트릭

### 초보자 팁
1. **멘탈 파워 관리가 핵심**: 항상 20 이상 유지
2. **체력 50% 이하 시 방어**: 치유/보호막 우선
3. **반사 상태 확인**: 공격 전 상대 상태 체크
4. **필드 마법 적극 활용**: 게임 흐름 변화

### 중급자 팁
1. **멘탈 파워 전이 활용**: 공격으로 멘탈 파워 획득
2. **디버프 타이밍**: 상대 중요 턴에 방해
3. **바운스 체인 계산**: 튕겨질 타겟 예측
4. **카드 조합 연구**: 시너지 효과 극대화

### 고급자 팁
1. **반사 체인 유도**: 상대끼리 데미지 교환 유도
2. **멘탈 파워 차단**: 공격으로 상대 멘탈 파워 감소
3. **필드 마법 카운터**: 타이밍 읽고 대응
4. **심리전**: 약해 보이다가 역전

---

## 용어 사전

| 용어 | 설명 |
|------|------|
| **멘탈 파워 (Mental Power)** | 카드 사용 비용, 턴당 +10 충전 |
| **반사 (Reflect)** | 받은 데미지를 공격자에게 50% 돌려줌 |
| **바운스 (Bounce)** | 받은 데미지를 다른 플레이어에게 50% 튕김 |
| **디버프 (Debuff)** | 일시적인 부정적 상태 효과 |
| **필드 마법 (Field Magic)** | 전체 게임판에 영향을 주는 효과 |
| **체인 (Chain)** | 반사/바운스가 연속적으로 발동하는 현象 |
| **멘탈 파워 전이 (Transfer)** | 데미지를 입히면 멘탈 파워 획득 |

---

**작성일**: 2025-11-01  
**게임 버전**: 1.0.0  
**난이도**: ⭐⭐⭐ (중급)
